let remainingTimeId,timer=chrome.extension.getBackgroundPage(),remainingMsSec=0,hr=0,min=0,timerState="",remainingTimeStr="";function setWorkingHours(){hr=$("#t_hr").val(),min=$("#t_min").val(),""==hr&&(hr=0),""==min&&(min=0),chrome.storage.sync.set({timer_hr:hr}),chrome.storage.sync.set({timer_min:min});try{timer.setTimer(hr,min),$("#cancel_btn_div").show(),$("#set_btn_div").hide(),$("#submit_btn_div").hide(),$("#err_div").html("Timer Set Successfully!")}catch(e){$("#err_div").html(e)}setTimeout(()=>{$("#err_div").html("")},5e3)}function cancelTimerFunc(){try{timer.cancelTimer(),$("#err_div").html("Timer is cancelled"),chrome.storage.sync.set({timer_hr:0}),chrome.storage.sync.set({timer_min:0}),$("#cancel_btn_div").hide(),$("#set_btn_div").show()}catch(e){$("#err_div").html(e)}setTimeout(()=>{$("#err_div").html("")},5e3)}function pauseTimerFunc(){try{timer.pauseTimer(),$("#err_div").html("Timer is paused")}catch(e){$("#err_div").html(e)}setTimeout(()=>{$("#err_div").html("")},5e3)}function restartTimerFunc(){try{timer.restartTimer(),$("#err_div").html("Timer is set")}catch(e){$("#err_div").html(e)}setTimeout(()=>{$("#err_div").html("")},5e3),remainingTimeId=setInterval(showRemainingTime,500)}function showRemainingTime(){"set"==(timerState=timer.getTimerState())?($("#cancel_btn_div").show(),$("#time_left").show(),$("#submit_btn_div").hide(),$("#set_btn_div").hide(),""!=(remainingTimeStr=timer.getRemainingTime())?(document.getElementById("time_left").innerHTML="Time Left : "+remainingTimeStr,showBadge(remainingTimeStr)):(document.getElementById("time_left").innerHTML=remainingTimeStr,""==(timerState=timer.getTimerState())&&clearTimeout(remainingTimeId))):""==timerState?($("#submit_btn_div").show(),$("#set_btn_div").show(),$("#cancel_btn_div").hide(),$("#time_left").hide()):"paused"==timerState&&clearTimeout(remainingTimeId)}function showBadge(e){let t="",i=e.split(":");i[0]>0&&(t+=parseInt(i[0])+"H"),i[1]>0&&(t+=parseInt(i[1])+"M"),i[2]>0&&""==t&&(t=parseInt(i[2])+"S"),chrome.browserAction.setBadgeBackgroundColor({color:"#ff0000"}),chrome.browserAction.setBadgeText({text:t})}chrome.runtime.onInstalled.addListener(function(e){"install"==e.reason&&($("#time_left").hide(),$("#set_btn_div").show())}),showRemainingTime(),remainingTimeId=setInterval(showRemainingTime,500),document.getElementById("setTimer").addEventListener("click",setWorkingHours),document.getElementById("cancelTimer").addEventListener("click",cancelTimerFunc),document.getElementById("pauseTimer").addEventListener("click",pauseTimerFunc),document.getElementById("restartTimer").addEventListener("click",restartTimerFunc),chrome.notifications.onButtonClicked.addListener(function(e,t){e===myNotificationID&&0===t&&stopSound()});
